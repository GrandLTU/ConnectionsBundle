parameters:
    ongr_project.extractor.descriptor.class: ONGR\ConnectionsBundle\Sync\Extractor\Descriptor\ExtractorDescriptor
    ongr_project.extractor.join_relation.class: ONGR\ConnectionsBundle\Sync\Extractor\Descriptor\JoinRelation
    ongr_project.sql_relations.category.fields:
        - OXTITLE
    # import modifier test class.
    ongr_connections.import.modifier.class: ONGR\ConnectionsBundle\Tests\Functional\Fixtures\ImportCommandTest\TestModifyEventListener
    # sync execute test class.
    ongr_connections.sync.execute.modifier.class: ONGR\ConnectionsBundle\Tests\Functional\Fixtures\SyncCommandsTest\TestModifyEventListener

services:
    ongr_project.sql_relations.category.delete:
        class: %ongr_project.extractor.descriptor.class%
        arguments: [oxcategories, D, OLD.OXID, 1, category]
        tags:
            - { name: ongr_connections.extractor_descriptor }
        calls:
            - [ addRelation, [ @ongr_project.sql_relations.category.join.articles ] ]

    ongr_project.sql_relations.category.update:
        class: %ongr_project.extractor.descriptor.class%
        arguments: [oxcategories, U, OLD.OXID, 1, category, %ongr_project.sql_relations.category.fields%]
        tags:
            - { name: ongr_connections.extractor_descriptor }
        calls:
            - [ addRelation, [ @ongr_project.sql_relations.category.join.articles ] ]

    ongr_project.sql_relations.category.join.articles:
        class: %ongr_project.extractor.join_relation.class%
        arguments: [oxobject2category AS oc, oc.OXOBJECTID, oc.OXCATNID=NEW.OXID, product, U, 1]

    ongr_project.sql_relations.product.create:
        class: %ongr_project.extractor.descriptor.class%
        arguments: [oxarticles, C, NEW.OXID, 1, product]
        tags:
            - { name: ongr_connections.extractor_descriptor }

    ongr_project.sql_relations.product.update:
        class: %ongr_project.extractor.descriptor.class%
        arguments: [oxarticles, U, OLD.OXID, 1, product]
        tags:
            - { name: ongr_connections.extractor_descriptor }

    ongr_project.sql_relations.product.delete:
        class: %ongr_project.extractor.descriptor.class%
        arguments: [oxarticles, D, OLD.OXID, 1, product]
        tags:
            - { name: ongr_connections.extractor_descriptor }

    ongr_project.sql_relations.category.product.update:
        class: %ongr_project.extractor.descriptor.class%
        arguments: [oxcategories, U, OLD.OXID]
        tags:
            - { name: ongr_connections.extractor_descriptor }
        calls:
            - [ addRelation, [ @ongr_project.sql_relations.category.join.articles ] ]
